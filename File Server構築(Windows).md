

# Windows Serverでファイルサーバーを構築する
---

## シナリオ
この演習では、Windows Serverでファイルサーバーを構築する手順を学習します。   

"C:\Share" フォルダを作成し、クライアントからアクセス可能な共有フォルダとしてネットワークに公開します。  

公開するフォルダには、セキュリティ設定としてのアクセス許可が必要です。  
Windowsの共有フォルダのアクセス許可には、「共有アクセス許可」と「NTFSアクセス許可」の両方を設定します。  
今回の演習では、共有アクセス許可にはフルコントロールを設定し、NTFSアクセス許可で詳細を指定します。

共有フォルダにアクセスするユーザーアカウントは、WindowsローカルユーザーとしてWindows Serverで作成します。
"Tom"と"Jerry"の2つのユーザーアカウントを作成し、Jerryを "File Server Users" グループに所属させます。

File Server Users グループに所属するJerryは共有フォルダのファイルに読み書きができます。  
Tomに対しては読みとり権限のみを与えて、書き込みを禁止します。  

ファイルサーバーの動作確認として、Clientから共有フォルダにアクセスしてファイルの読み書きをテストします。  


## 演習の意図
    演習ガイドを参照して演習の意図をあらかじめ確認してください
[ppt]
- aaa  


## 演習における役割と、環境のパラメータ
- X: ご自身のPod番号
- Windowsファイルサーバー役: WinSrv2(WSrv2-yyMMddX)
- Windows Client: WinClient



## 注意
- 手順例の画像は<B>pod255</B>に準拠したパラメータのものです
- 手順内の<B>X</B>表記はご自身のpod番号に読み替えてください

---

## 1. Windowsファイルサーバー構築の準備
この演習では、Windows Server2(WinSrv2)をWindowsファイルサーバーとして構築します。  

1. Windowsファイルサーバー(WinSrv2)の管理画面に接続する  
1. [スタートメニュー]を右クリックし、コンテキストメニュー内の[Windows PowerShell(管理者)]をクリックする  
1. [ユーザー アカウント制御]のポップアップで[はい]をクリックする  
1. Windows PowerShellのウィンドウが表示されたことを確認する  
1. 以下のコマンドを実行し、Windowsファイルサーバー役のコンピュータ(WinSrv2)に接続していることを確認する  
    ＞ ***hostname***  
    
    > 【補足】  
    > Windowsファイルサーバー役のコンピュータであるWinSrv2には、"WSrv2-yyMMddX(年月日とPod番号)"形式のホスト名が設定されています。  


## 2. Windowsローカルユーザーアカウントの管理  
1. ローカルユーザー管理コンソールを起動する  
    1. [スタートメニュー]をクリックする  
    1. スタートメニュー内の[サーバー マネージャー]をクリックし、サーバーマネージャを起動する  
    1. サーバーマネージャーウィンドウ右上の[ツール]をクリックする  
    1. メニュー内の[コンピュータの管理]をクリックし、管理コンソールを起動する  
        <kbd>![img](image/05/14.png)</kbd>

1. ローカルユーザー(TomとJerry)を作成する  
    1. 左側コンソールツリーの[コンピュータの管理]-[システムツール]-[ローカル ユーザーとグループ]-[ユーザー]をクリックする  
    1. 左側コンソールツリーの[ユーザー]を右クリックし、コンテキストメニューの[新しいユーザー]をクリックする  
        <kbd>![img](image/05/15.png)</kbd>  
    1. [新しいユーザー]ウィンドウが表示されたことを確認する  
    1. 以下のパラメータを入力する

        | 項目 | パラメータ |
        | :----- | :----- |
        | ユーザー名 | Tom |
        | フル ネーム | <空欄> |
        | 説明 | <空欄> |  
        | パスワード | Pa$$w0rd |
        | パスワードの確認入力 | Pa$$w0rd |  

        - [ ] ユーザーは次回ログオン時にパスワードの変更が必要
        - [ ] ユーザーはパスワードの変更ができない
        - [x] パスワードを無期限にする
        - [ ] アカウントを無効にする
        <kbd>![img](image/05/15_2.png)</kbd> 
    1. 前項のパラメータを入力した後、[作成]ボタンをクリックする
    1. [閉じる]ボタンをクリックする
    1. 中央ペインのユーザーの一覧を参照し、"Tom" が作成されていることを確認する
        <kbd>![img](image/05/15_3.png)</kbd> 

    1. 左側コンソールツリーの[ユーザー]を右クリックし、コンテキストメニューの[新しいユーザー]をクリックする  
    1. [新しいユーザー]ウィンドウが表示されたことを確認する  
    1. 以下のパラメータを入力する

        | 項目 | パラメータ |
        | :----- | :----- |
        | ユーザー名 | Jerry |
        | フル ネーム | <空欄> |
        | 説明 | <空欄> |  
        | パスワード | Pa$$w0rd |
        | パスワードの確認入力 | Pa$$w0rd |  

        - [ ] ユーザーは次回ログオン時にパスワードの変更が必要
        - [ ] ユーザーはパスワードの変更ができない
        - [x] パスワードを無期限にする
        - [ ] アカウントを無効にする
        <kbd>![img](image/05/15_4.png)</kbd> 
    1. 前項のパラメータを入力した後、[作成]ボタンをクリックする
    1. [閉じる]ボタンをクリックする
    1. 中央ペインのユーザーの一覧を参照し、"Jerry" が作成されていることを確認する
        <kbd>![img](image/05/15_5.png)</kbd> 


1. ローカルグループ(File Server Users)を作成する  
    1. 左側コンソールツリーの[コンピュータの管理]-[システムツール]-[ローカル ユーザーとグループ]-[グループ]をクリックする  
    1. 左側コンソールツリーの[グループ]を右クリックし、コンテキストメニューの[新しいグループ]をクリックする  
        <kbd>![img](image/05/16.png)</kbd> 
    1. [新しいグループ]ウィンドウが表示されたことを確認する  
        <kbd>![img](image/05/17.png)</kbd> 
    1. 以下のパラメータを入力する  

        | 項目 | パラメータ |
        | :----- | :----- |
        | グループ名 | File Server Users |
        | 所属するメンバー | <空欄> |

    1. 前項のパラメータを入力した後、[作成]ボタンをクリックする  
    1. [閉じる]ボタンをクリックする  
    1. 中央ペインのグループの一覧を参照し、"File Server Users" が作成されていることを確認する  
        <kbd>![img](image/05/19.png)</kbd> 

1. ローカルグループ(File Server Users)にユーザー(Jerry)を所属させる  
    1. 中央ペインのグループの一覧を参照し、[File Server Users]をクリックする  
    1. [File Server Users]を右クリックし、コンテキストメニューの[プロパティ]をクリックする  
        <kbd>![img](image/05/20.png)</kbd> 
    1. 所属するメンバー欄の下の[追加]をクリックする  
        <kbd>![img](image/05/21.png)</kbd> 
    1. [ユーザーの選択]ウィンドウが表示されたことを確認する  
        <kbd>![img](image/05/22.png)</kbd> 
    1. "選択するオブジェクト名を入力してください" の欄に "Jerry" と入力する  
        <kbd>![img](image/05/23.png)</kbd> 
    1. [名前の確認]をクリックする  
    1. "<コンピュータ名>￥Jerry" の表記に下線がついたことを確認する  
        <kbd>![img](image/05/24.png)</kbd> 
    1. [OK]をクリックする  
    1. [新しいグループ]ウィンドウの "所属するメンバー" に "Jerry" が表示されていることを確認する
        <kbd>![img](image/05/25.png)</kbd> 
    1. [OK]をクリックする  


## 3. フォルダ(C:\Share)を共有する  
この手順では、ファイルサーバーのデータを保存するフォルダ(C:\Share)を作成し、共有フォルダとしてネットワークに公開します。  

1. C:\Shareフォルダを作成する   
    1. ファイル エクスプローラーを起動する   
    1. Cドライブ直下にアクセスする  
    1. 右クリック コンテキストメニューの[新規作成]-[フォルダー]をクリックする
        <kbd>![img](image/05/31.png)</kbd> 
    1. 作成された新しいフォルダの名前を "Share" に変更する  
        <kbd>![img](image/05/32.png)</kbd> 

1. フォルダをネットワークに公開し、共有アクセス許可を設定する
    1. [Share]フォルダをクリックし、右クリック コンテキストメニューの[プロパティ]をクリックする
    1. [プロパティ]ウィンドウの[共有]タブをクリックする
    1. [詳細な共有] をクリックする
        <kbd>![img](image/05/34.png)</kbd> 
    1. 以下のパラメータを入力する

        - [x] このフォルダーを共有する

        | 項目 | パラメータ |
        | :----- | :----- |
        | 共有名 | Share |
        | 同時共有できるユーザー数 | 1677721 |
        | コメント| <空欄> |
    
        <kbd>![img](image/05/35.png)</kbd> 

    1. [アクセス許可] をクリックする
    1. [Shareのアクセス許可]ウィンドウが表示されたのを確認する
        <kbd>![img](image/05/37.png)</kbd> 
    1. [Everyone]をクリックして選択し、[フルコントロール]の "許可" にチェックをつける
        <kbd>![img](image/05/38.png)</kbd> 
    1. [Shareのアクセス許可]ウィンドウで、[OK]をクリックする  
    1. [詳細な共有]ウィンドウで、[OK]をクリックする  
        <kbd>![img](image/05/39.png)</kbd> 
    1. [プロパティ]ウィンドウで、[閉じる]をクリックする  
        <kbd>![img](image/05/40.png)</kbd>

1. 共有フォルダのステータスを確認する
    1. PowerShellを起動する
    1. 以下のコマンドを実行し、C:¥Shareフォルダが "Share" という共有名でネットワークに公開されていることを確認する
        ＞ ***net share***  
    
        <kbd>![img](image/05/41.png)</kbd>

        
1. "C:\Share" フォルダを右クリックして、"共有" タブを選択する。"共有を開始する"をクリックして、フォルダをネットワーク上で公開する。  
1. [フォルダのプロパティ]ウィンドウで、"共有" タブを選択し、"フルコントロール"の権限を設定する。次に、"セキュリティ" タブを選択して、NTFSアクセス許可を詳細に設定する。  
1. [コントロールパネル] > [管理ツール] > [コンピュータの管理]を開き、"ローカルユーザーとグループ"から新しいユーザー"Tom"および"Jerry"を作成する。  
1. "Jerry"ユーザーを右クリックして、"所属するグループ"を選択し、"File Server Users"グループに追加する。  
1. "C:\Share" フォルダの[プロパティ]ウィンドウで、"セキュリティ" タブを選択し、"Jerry"に読み書き権限を、"Tom"には読み取り権限のみを付与する。  
1. クライアントコンピューターから、"C:\Share"共有フォルダにアクセスして、ファイルの読み書きができるかテストする。  

